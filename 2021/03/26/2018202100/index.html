<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>AI Tello Flight | 王硕的博客</title><meta name="author" content="王硕"><meta name="copyright" content="王硕"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="智能无人机王硕     2018202100 github：https:&#x2F;&#x2F;github.com&#x2F;markinruc&#x2F;ai20projects&#x2F;tree&#x2F;master&#x2F;2018202100  可惜，图片加载不出来，难过  2020.10.30项目概论我们小组对于无人机项目的进度目前可大致分为三个阶段：  使用Python程序完成对无人机的基本操控 结合语音识别技术 结合图像识别技术  阶段一  P">
<meta property="og:type" content="article">
<meta property="og:title" content="AI Tello Flight">
<meta property="og:url" content="http://example.com/2021/03/26/2018202100/index.html">
<meta property="og:site_name" content="王硕的博客">
<meta property="og:description" content="智能无人机王硕     2018202100 github：https:&#x2F;&#x2F;github.com&#x2F;markinruc&#x2F;ai20projects&#x2F;tree&#x2F;master&#x2F;2018202100  可惜，图片加载不出来，难过  2020.10.30项目概论我们小组对于无人机项目的进度目前可大致分为三个阶段：  使用Python程序完成对无人机的基本操控 结合语音识别技术 结合图像识别技术  阶段一  P">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2021-03-26T06:55:25.899Z">
<meta property="article:modified_time" content="2021-03-27T12:31:24.391Z">
<meta property="article:author" content="王硕">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/mark.jpg"><link rel="canonical" href="http://example.com/2021/03/26/2018202100/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-03-27 20:31:24'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="王硕的博客" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/mark.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">王硕的博客</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">AI Tello Flight</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-03-26T06:55:25.899Z" title="发表于 2021-03-26 14:55:25">2021-03-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-03-27T12:31:24.391Z" title="更新于 2021-03-27 20:31:24">2021-03-27</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="智能无人机"><a href="#智能无人机" class="headerlink" title="智能无人机"></a>智能无人机</h1><p>王硕     2018202100</p>
<p>github：<a target="_blank" rel="noopener" href="https://github.com/markinruc/ai20projects/tree/master/2018202100">https://github.com/markinruc/ai20projects/tree/master/2018202100</a></p>
<blockquote>
<p>可惜，图片加载不出来，难过</p>
</blockquote>
<h1 id="2020-10-30"><a href="#2020-10-30" class="headerlink" title="2020.10.30"></a>2020.10.30</h1><h2 id="项目概论"><a href="#项目概论" class="headerlink" title="项目概论"></a>项目概论</h2><p>我们小组对于无人机项目的进度目前可大致分为三个阶段：<br></p>
<ol>
<li>使用Python程序完成对无人机的基本操控</li>
<li>结合语音识别技术</li>
<li>结合图像识别技术</li>
</ol>
<h2 id="阶段一-Python操纵无人机"><a href="#阶段一-Python操纵无人机" class="headerlink" title="阶段一  Python操纵无人机"></a>阶段一  Python操纵无人机</h2><p>我们最初的想法是使用Tello的原生接口实现对无人机的操纵，其中需要使用socket向无人机发送指令，如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#连接tello</span></span><br><span class="line">tello_address = (<span class="string">&#x27;192.168.10.1&#x27;</span>, <span class="number">8889</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#本地计算机的Ip和端口</span></span><br><span class="line">local_address = (<span class="string">&#x27;&#x27;</span>, <span class="number">9000</span>)</span><br><span class="line"><span class="comment">#local_address = (&#x27;192.168.10.2&#x27;, 139)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#创建一个UDP连接用于发送命令</span></span><br><span class="line">sock = socket.socket(socket.AF_INET,socket.SOCK_DGRAM)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绑定到本地地址和端口</span></span><br><span class="line">sock.bind(local_address)</span><br></pre></td></tr></table></figure>
<p>但是由于Windows系统与Tello系统的网络编程兼容性不好，因此这种连接不太稳定，且网络编程底层技术并不是本项目的重点，为了使这一部分变得简洁且有效，我们最终使用了tellopy这一Python的库，实现对无人机的高效操控，以下为tellopy的类与部分方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tello</span>(<span class="params">builtins.<span class="built_in">object</span></span>)</span></span><br><span class="line"><span class="class"> |  <span class="title">Tello</span>(<span class="params">port=<span class="number">9000</span></span>)</span></span><br><span class="line"><span class="class"> |</span></span><br><span class="line"><span class="class"> |  <span class="title">Methods</span> <span class="title">defined</span> <span class="title">here</span>:</span></span><br><span class="line"> |</span><br><span class="line"> |  __init__(self, port=<span class="number">9000</span>)</span><br><span class="line"> |      Initialize self.  See <span class="built_in">help</span>(<span class="built_in">type</span>(self)) <span class="keyword">for</span> accurate signature.</span><br><span class="line"> |</span><br><span class="line"> |  backward(self, val)</span><br><span class="line"> |      Backward tells the drone to go <span class="keyword">in</span> reverse. Pass <span class="keyword">in</span> an <span class="built_in">int</span> <span class="keyword">from</span> <span class="number">0</span>-<span class="number">100.</span></span><br><span class="line"> |</span><br><span class="line"> |  clockwise(self, val)</span><br><span class="line"> |      Clockwise tells the drone to rotate <span class="keyword">in</span> a clockwise direction.</span><br><span class="line"> |      Pass <span class="keyword">in</span> an <span class="built_in">int</span> <span class="keyword">from</span> <span class="number">0</span>-<span class="number">100.</span></span><br><span class="line"> |</span><br><span class="line"> |  connect(self)</span><br><span class="line"> |      Connect <span class="keyword">is</span> used to send the initial connection request to the drone.</span><br><span class="line"> |</span><br><span class="line"> |  counter_clockwise(self, val)</span><br><span class="line"> |      CounterClockwise tells the drone to rotate <span class="keyword">in</span> a counter-clockwise direction.</span><br><span class="line"> |      Pass <span class="keyword">in</span> an <span class="built_in">int</span> <span class="keyword">from</span> <span class="number">0</span>-<span class="number">100.</span></span><br><span class="line"> |</span><br><span class="line"> |  down(self, val)</span><br><span class="line"> |      Down tells the drone to descend. Pass <span class="keyword">in</span> an <span class="built_in">int</span> <span class="keyword">from</span> <span class="number">0</span>-<span class="number">100.</span></span><br><span class="line"> |</span><br><span class="line"> |  flip_back(self)</span><br><span class="line"> |      flip_back tells the drone to perform a backwards flip</span><br><span class="line"> |</span><br><span class="line"> |  flip_backleft(self)</span><br><span class="line"> |      flip_backleft tells the drone to perform a backwards left flip</span><br><span class="line"> |</span><br><span class="line"> |  flip_backright(self)</span><br><span class="line"> |      flip_backleft tells the drone to perform a backwards right flip</span><br><span class="line"> |</span><br><span class="line"> |  flip_forward(self)</span><br><span class="line"> .......</span><br></pre></td></tr></table></figure>
<h2 id="阶段二-无人机与语音识别的结合"><a href="#阶段二-无人机与语音识别的结合" class="headerlink" title="阶段二 无人机与语音识别的结合"></a>阶段二 无人机与语音识别的结合</h2><p>这一部分我们主要借助计算机接收到人发出的语音指令，经过Python实现的算法进行识别，然后将执行对应的无人机操纵函数实现对无人机的操控。<br><img src="https://cdn.jsdelivr.net/gh/markinruc/cdn@1.0//sound1.png" alt="avatar"><br><img src="https://cdn.jsdelivr.net/gh/markinruc/cdn@1.0/sound2.png" alt="avatar"><br>测试视频：</p>
<blockquote>
<p>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1n9AiKVfvzHp84XZP-VlgWQ">https://pan.baidu.com/s/1n9AiKVfvzHp84XZP-VlgWQ</a><br>提取码：i7j0<br>复制这段内容后打开百度网盘手机App，操作更方便哦</p>
</blockquote>
<p>这一部分的代码路径为 <a href="src/scripts/face_recognition">src/scripts/face_recognition</a></p>
<h2 id="无人机与人脸识别的结合"><a href="#无人机与人脸识别的结合" class="headerlink" title="无人机与人脸识别的结合"></a>无人机与人脸识别的结合</h2><p>由于我们上个学期选修过多媒体技术课程，因此对图像识别有一定的了解。我们目前的设计是根据无人机传输到计算机上的视频流，识别出人脸，根据人脸的移动，调整无人机的旋转角度，实现无人机的镜头跟着人脸一起移动的效果。<br>测试视频：</p>
<blockquote>
<p>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1n9AiKVfvzHp84XZP-VlgWQ">https://pan.baidu.com/s/1n9AiKVfvzHp84XZP-VlgWQ</a><br>提取码：i7j0<br>复制这段内容后打开百度网盘手机App，操作更方便哦</p>
</blockquote>
<p>这一部分的代码路径为：<a href="src/scripts/speech_recognition">src/scripts/speech_recognition</a></p>
<h2 id="下一阶段的目标"><a href="#下一阶段的目标" class="headerlink" title="下一阶段的目标"></a>下一阶段的目标</h2><ul>
<li>目前各个阶段的功能相对独立，没有融合到一起，希望接下来增加项目整体的整合性</li>
<li>利用我们实现的部分功能，结合现实生活解决一些问题</li>
</ul>
<h1 id="2020-11-20"><a href="#2020-11-20" class="headerlink" title="2020.11.20"></a>2020.11.20</h1><h2 id="阶段三"><a href="#阶段三" class="headerlink" title="阶段三"></a>阶段三</h2><h2 id="物体识别"><a href="#物体识别" class="headerlink" title="物体识别"></a>物体识别</h2><p>从10.30日之后，我们小组主要从语音和视觉两个方面开始探索，其中我主要负责视觉方面的物体检测，这一期间我主要尝试了tensorflow object detection 和 yolo两大物体识别框架，并尝试在本地运行的同时与无人机进行结合。</p>
<h4 id="tensorflow-object-detection"><a href="#tensorflow-object-detection" class="headerlink" title="tensorflow object detection"></a>tensorflow object detection</h4><p>框架链接：<a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/tree/master/research/object_detection">https://github.com/tensorflow/models/tree/master/research/object_detection</a><br>官网描述：</p>
<blockquote>
<p>Creating accurate machine learning models capable of localizing and identifying multiple objects in a single image remains a core challenge in computer vision. The TensorFlow Object Detection API is an open source framework built on top of TensorFlow that makes it easy to construct, train and deploy object detection models. At Google we’ve certainly found this codebase to be useful for our computer vision needs, and we hope that you will as well.</p>
</blockquote>
<p>简言之，就是可以在同一张图片中检测并标注目标，而且对用户自己进行训练、应用十分友好。再历经千辛万苦，疯狂配置各种环境之后，我终于在本地成功搭建起来，并且导入了预训练模型，使用官方依据coco数据集训练得到的预权重，成功实现了目标检测。</p>
<p>测试图片：</p>
<img src="extra\tf1.png" alt="image-20201120204837319" style="zoom:67%;" />

<p>为了更契合我们的项目，我们使用框架处理摄像头传输的视频，实现了即视的识别：</p>
<img src="extra\tf2.jpg" alt="978984fe212d13545d8e30a2bac2f1e" style="zoom:67%;" />

<p>部分代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> image_path <span class="keyword">in</span> TEST_IMAGE_PATHS:</span><br><span class="line">  image = Image.<span class="built_in">open</span>(image_path)</span><br><span class="line">  <span class="comment"># the array based representation of the image will be used later in order to prepare the</span></span><br><span class="line">  <span class="comment"># result image with boxes and labels on it.</span></span><br><span class="line">  image_np = load_image_into_numpy_array(image)</span><br><span class="line">  <span class="comment"># Expand dimensions since the model expects images to have shape: [1, None, None, 3]</span></span><br><span class="line">  image_np_expanded = np.expand_dims(image_np, axis=<span class="number">0</span>)</span><br><span class="line">  <span class="comment"># Actual detection.</span></span><br><span class="line">  output_dict = run_inference_for_single_image(image_np, detection_graph)</span><br><span class="line">  <span class="comment"># Visualization of the results of a detection.</span></span><br><span class="line">  vis_util.visualize_boxes_and_labels_on_image_array(</span><br><span class="line">      image_np,</span><br><span class="line">      output_dict[<span class="string">&#x27;detection_boxes&#x27;</span>],</span><br><span class="line">      output_dict[<span class="string">&#x27;detection_classes&#x27;</span>],</span><br><span class="line">      output_dict[<span class="string">&#x27;detection_scores&#x27;</span>],</span><br><span class="line">      category_index,</span><br><span class="line">      instance_masks=output_dict.get(<span class="string">&#x27;detection_masks&#x27;</span>),</span><br><span class="line">      use_normalized_coordinates=<span class="literal">True</span>,</span><br><span class="line">      line_thickness=<span class="number">8</span>)</span><br><span class="line">  plt.figure(figsize=IMAGE_SIZE)</span><br><span class="line">  plt.imshow(image_np)</span><br><span class="line">  plt.show()</span><br></pre></td></tr></table></figure>
<p>完整代码参考/src/scripts/object_detection/object_detection_tutorial.ipynb</p>
<h4 id="YOLO"><a href="#YOLO" class="headerlink" title="YOLO"></a>YOLO</h4><p>模型链接：<a target="_blank" rel="noopener" href="https://pjreddie.com/darknet/yolo/">https://pjreddie.com/darknet/yolo/</a></p>
<p>yolo模型目前已经发展到了v5版本，我们分别尝试了v3、v4、v5三个版本，大约5、6个预训练模型，使用opencv作为图片处理工具，导入yolo的网络模型和与训练权重,其中v4版本的准确率较高，但是在我的电脑本地上处理速度较慢，大约0.7s处理一帧，目前不符合无人机即时检测的要求。v5版本准确率稍微逊色，但是效率比v4版本提高了十倍，已经符合了无人机的要求。</p>
<p>测试图片：</p>
<img src="\extra\yolo.png" alt="656c85d4b5d55089fd1fae986ee39c5" style="zoom: 50%;" />

<h4 id="缺陷和方向"><a href="#缺陷和方向" class="headerlink" title="缺陷和方向"></a>缺陷和方向</h4><ul>
<li>目前所有的框架和模型都是通过CPU进行运算，效率较低，应用到摄像头上之后跳帧更为明显，特别是yolo-v4。下一步的解决方案是利用本地的英伟达1050Ti 的GPU进行运行，主要的难点在与配置显卡的驱动和cudnn加速，其实在这方面这周已经踩了不少的坑，但是最终仍然没有成功应用。下一阶段完成后，预计效率将会大大提升。</li>
<li>目前使用的模型为官方预训练模型，可以检测通用的物体 ，如人体、水杯等。我们目前已经开始使用labelimg工具标注自己的数据集进行训练，如我们自己的人脸、无人机的未来跟踪的小球等，以实现个性化的目标识别。</li>
<li>由于框架的环境配置过程复杂，不同的硬件设备、系统会有不同的方案和问题，所以本项目可移植性较差，需要先按照各个模型的官方文档配置环境。</li>
</ul>
<h2 id="手势识别"><a href="#手势识别" class="headerlink" title="手势识别"></a>手势识别</h2><p>我们j基于百度api初步实现了手势识别技术，测试时我们用自己电脑摄像头（连无人机摄像头同理）实时识别屏幕里出现的手势。目前可以识别1~9九个手势，可以将识别到的手势与无人机的动作联系起来。比如，我们可以指定手势“1”对应takeoff()动作。</p>
<p>手势识别代码放在：<a href="src/scripts/gesture_recongnize/gesture_recongnize.py">src/scripts/gesture_recongnize/gesture_recongnize.py</a></p>
<p>测试手势识别过程的一张图片如下（全部图片放在<a href="src/dataset/gesture_pictures">src/dataset/gesture_pictures</a>下）：</p>
<p><img src="F:/aaaa/AI/2018202100/extra/手势识别过程.png" alt="avatar"></p>
<p>手势识别效果如下：</p>
<p><img src="F:/aaaa/AI/2018202100/extra/手势识别结果.png" alt="avatar"></p>
<p>可以看到1~9九个手势都可以正常识别出来。</p>
<h2 id="无人机飞行路线规划"><a href="#无人机飞行路线规划" class="headerlink" title="无人机飞行路线规划"></a>无人机飞行路线规划</h2><p>为了让无人机可以按照我们规定的路径进行飞行，我们基于pygame的图形界面实现了一个控制无人机飞行的GUI。以一张中国人民大学的地图图片为例，我们可以在图片上点击要飞行的路径，路线规划函数会把它实际要飞行的路线保存到相应的JSON文件中，根据JSON文件中的数据来控制无人机要飞行的距离、旋转的角度等。</p>
<p>路线规划代码包括：（其中path_plan.py用来根据点击的路线生成JSON文件，tello_path_plan.py用来根据JSON文件控制无人机飞行）</p>
<p><a href="src/scripts/path_plan/path_plan.py">src/scripts/path_plan/path_plan.py</a></p>
<p><a href="src/scripts/path_plan/tello_path_plan.py">src/scripts/path_plan/tello_path_plan.py</a></p>
<p>路线规划的效果如下：</p>
<p>在GUi界面上点击如下路线（绕操场的路径）：</p>
<p><img src="F:/aaaa/AI/2018202100/extra/路线规划过程.png" alt="avatar"></p>
<p>然后会产生刚刚这个路径的信息，路径信息会保存到相应的JSON文件中<a href="src/scripts/path_plan/waypoints.json">src/scripts/path_plan/waypoints.json</a>：</p>
<p><img src="extra/%E8%B7%AF%E7%BA%BF%E8%A7%84%E5%88%92%E7%BB%93%E6%9E%9C.png" alt="avatar"></p>
<h2 id="期末汇总"><a href="#期末汇总" class="headerlink" title="期末汇总"></a>期末汇总</h2><h3 id="小组成果汇总"><a href="#小组成果汇总" class="headerlink" title="小组成果汇总"></a>小组成果汇总</h3><ul>
<li><p>人脸捕捉，追踪飞行</p>
<ul>
<li>训练四位小组成员的脸部图像数据，准确识别和跟踪飞行</li>
</ul>
</li>
<li><p>手势识别，手势控制</p>
<ul>
<li>通过图像识别手势，控制降落等操作</li>
</ul>
</li>
<li><p>语音控制，第二感官</p>
<ul>
<li>通过语音识别控制无人机的起飞和降落等操作</li>
</ul>
</li>
<li><p>自动避障系统</p>
<ul>
<li>以网球为例，通过图像识别，躲避网球</li>
</ul>
</li>
<li><p>双模式切换系统</p>
<ul>
<li>无人机识别到”switch”手势后，可以切换无人机飞行模式</li>
</ul>
</li>
</ul>
<h3 id="个人工作汇总"><a href="#个人工作汇总" class="headerlink" title="个人工作汇总"></a>个人工作汇总</h3><ul>
<li><p>研究无人机软硬件接口，探索Tellopy使用方法</p>
<ul>
<li>通过Python实现对无人机的控制，为后续复杂算法实现奠定基础</li>
</ul>
</li>
<li><p>探索无人机物体识别的相关算法和模型</p>
<ul>
<li><p>尝试使用了谷歌人脸识别API，百度手势识别API两种在线模型</p>
</li>
<li><p>使用了Tensorflow objects detection和YOLO两种物体识别框架，初步实现了无人机通过计算机视觉识别物体的效果。</p>
</li>
<li><p>标注小组成员的人脸和手势数据集，每张手势和人脸100张。将网球作为障碍物，同样也标注作为数据集(出于小组成员隐私考虑，不会上传数据集，望谅解)。</p>
<img src="extra\label_stop.png" style="zoom:67%;" />
</li>
<li><p>基于我们自己标注的数据集，在YOLOv5的框架下训练我们自己的模型，最终达到了非常好的识别效果，识别准确率可以稳定在90%。可以达到以下效果：</p>
<img src="extra\障碍物识别效果.jpg" style="zoom: 50%;" />
</li>
<li><p>根据无人机摄像头传输的视频流进行识别，编写人脸追踪、手势识别、躲避障碍物的算法。</p>
<ul>
<li>人脸追踪：人脸识别的算法可以得到一个当前人脸在视频框中的坐标，我们希望将人脸框始终动态稳定在视频框的中央，根据当前的人脸坐标和视频框中心点的坐标，可以计算出无人机需要移动的向量，通过Tellopy接口将移动指令传递给无人机。</li>
<li>手势识别：手势识别算法得到当前手势识别的种类，每一个手势种类会对应一个具体的无人机移动信号，条件判断后发出对应信号即可。</li>
<li>躲避障碍：与人脸追踪算法某种程度上互为逆操作，识别出障碍物的坐标后，需要计算出将障碍物移出当前视频框的需要做出的最小移动向量。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="心得体会"><a href="#心得体会" class="headerlink" title="心得体会"></a>心得体会</h3><ul>
<li>前期准备。前期我们了解了很多的算法和模型，虽然其中大部分最终我们没有用到，看似浪费了时间，实际上开阔了视野，反而帮助我们在后期关键技术实现上面没有遇到太大的困难和错误。</li>
<li>动手能力。空谈模型和技术没有实际的意义，动手做出来才能算作结果。</li>
<li>团队协作。团队协作，扬长避短，我们小组四位成员，有些同学比较了解计算机视觉，有些同学比较擅长语言处理，各取所长，才能高效合作。</li>
<li>不要做无意义的功能的堆积，而是做一些有趣且有技术含量的东西。</li>
</ul>
<h3 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h3><blockquote>
<p>Python 3.7 及以上</p>
<p>Tensorflow 2.x</p>
</blockquote>
<h3 id="Package"><a href="#Package" class="headerlink" title="Package"></a>Package</h3><blockquote>
<ul>
<li>tellopy</li>
<li>pyaudio</li>
<li>aip</li>
<li>playsound</li>
<li>opencv</li>
<li>这只是部分包，可根据调试信息安装对应的Python包</li>
</ul>
</blockquote>
<h3 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h3><blockquote>
<p>若出现网络问题，请尝试以下方法</p>
<ul>
<li>使用Linux或MacOS</li>
<li>使用有线网络连接以便于WiFi连接无人机</li>
<li>若人脸识别出现问题，请关注代码中的路径问题，并不是所有IDE都能智能处理路径问题</li>
<li>tensorflow和yolo的环境配置请参考官方文档</li>
</ul>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">王硕</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2021/03/26/2018202100/">http://example.com/2021/03/26/2018202100/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">王硕的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/04/05/slam3/"><img class="prev-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">SLAM学习笔记(1)：三维物体刚体运动</div></div></a></div><div class="next-post pull-right"><a href="/2021/01/31/hello-world/"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Hello blog</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/mark.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">王硕</div><div class="author-info__description">飞光飞光劝尔一杯酒</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/markinruc"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/markinruc" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/myname_mark@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">多读书，多写作，每周一个小博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%99%BA%E8%83%BD%E6%97%A0%E4%BA%BA%E6%9C%BA"><span class="toc-number">1.</span> <span class="toc-text">智能无人机</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2020-10-30"><span class="toc-number">2.</span> <span class="toc-text">2020.10.30</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%A6%82%E8%AE%BA"><span class="toc-number">2.1.</span> <span class="toc-text">项目概论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B6%E6%AE%B5%E4%B8%80-Python%E6%93%8D%E7%BA%B5%E6%97%A0%E4%BA%BA%E6%9C%BA"><span class="toc-number">2.2.</span> <span class="toc-text">阶段一  Python操纵无人机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B6%E6%AE%B5%E4%BA%8C-%E6%97%A0%E4%BA%BA%E6%9C%BA%E4%B8%8E%E8%AF%AD%E9%9F%B3%E8%AF%86%E5%88%AB%E7%9A%84%E7%BB%93%E5%90%88"><span class="toc-number">2.3.</span> <span class="toc-text">阶段二 无人机与语音识别的结合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E4%BA%BA%E6%9C%BA%E4%B8%8E%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB%E7%9A%84%E7%BB%93%E5%90%88"><span class="toc-number">2.4.</span> <span class="toc-text">无人机与人脸识别的结合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E4%B8%80%E9%98%B6%E6%AE%B5%E7%9A%84%E7%9B%AE%E6%A0%87"><span class="toc-number">2.5.</span> <span class="toc-text">下一阶段的目标</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2020-11-20"><span class="toc-number">3.</span> <span class="toc-text">2020.11.20</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B6%E6%AE%B5%E4%B8%89"><span class="toc-number">3.1.</span> <span class="toc-text">阶段三</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%A9%E4%BD%93%E8%AF%86%E5%88%AB"><span class="toc-number">3.2.</span> <span class="toc-text">物体识别</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#tensorflow-object-detection"><span class="toc-number">3.2.0.1.</span> <span class="toc-text">tensorflow object detection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#YOLO"><span class="toc-number">3.2.0.2.</span> <span class="toc-text">YOLO</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%BA%E9%99%B7%E5%92%8C%E6%96%B9%E5%90%91"><span class="toc-number">3.2.0.3.</span> <span class="toc-text">缺陷和方向</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%8B%E5%8A%BF%E8%AF%86%E5%88%AB"><span class="toc-number">3.3.</span> <span class="toc-text">手势识别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E4%BA%BA%E6%9C%BA%E9%A3%9E%E8%A1%8C%E8%B7%AF%E7%BA%BF%E8%A7%84%E5%88%92"><span class="toc-number">3.4.</span> <span class="toc-text">无人机飞行路线规划</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%9F%E6%9C%AB%E6%B1%87%E6%80%BB"><span class="toc-number">3.5.</span> <span class="toc-text">期末汇总</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%84%E6%88%90%E6%9E%9C%E6%B1%87%E6%80%BB"><span class="toc-number">3.5.1.</span> <span class="toc-text">小组成果汇总</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AA%E4%BA%BA%E5%B7%A5%E4%BD%9C%E6%B1%87%E6%80%BB"><span class="toc-number">3.5.2.</span> <span class="toc-text">个人工作汇总</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%83%E5%BE%97%E4%BD%93%E4%BC%9A"><span class="toc-number">3.5.3.</span> <span class="toc-text">心得体会</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Environment"><span class="toc-number">3.5.4.</span> <span class="toc-text">Environment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Package"><span class="toc-number">3.5.5.</span> <span class="toc-text">Package</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Run"><span class="toc-number">3.5.6.</span> <span class="toc-text">Run</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/04/05/slam3/" title="SLAM学习笔记(1)：三维物体刚体运动"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SLAM学习笔记(1)：三维物体刚体运动"/></a><div class="content"><a class="title" href="/2021/04/05/slam3/" title="SLAM学习笔记(1)：三维物体刚体运动">SLAM学习笔记(1)：三维物体刚体运动</a><time datetime="2021-04-05T07:41:06.900Z" title="发表于 2021-04-05 15:41:06">2021-04-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/26/2018202100/" title="AI Tello Flight"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AI Tello Flight"/></a><div class="content"><a class="title" href="/2021/03/26/2018202100/" title="AI Tello Flight">AI Tello Flight</a><time datetime="2021-03-26T06:55:25.899Z" title="发表于 2021-03-26 14:55:25">2021-03-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/01/31/hello-world/" title="Hello blog"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello blog"/></a><div class="content"><a class="title" href="/2021/01/31/hello-world/" title="Hello blog">Hello blog</a><time datetime="2021-01-31T06:10:10.442Z" title="发表于 2021-01-31 14:10:10">2021-01-31</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 王硕</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>